---
aliases:
  - "MMU"
  - "memory management unit"
  - "–±–ª–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é"
tags:
  - "#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ #cpu #memory"
path:
  - "–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ/–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞/–ø–∞–º—è—Ç—å"
---

## üìå –ö—Ä–∞—Ç–∫–æ  
[[MMU]] (Memory Management Unit) ‚Äî –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π –±–ª–æ–∫ –≤–Ω—É—Ç—Ä–∏ [[root/CPU/CPU]], –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø–∞–º—è—Ç–∏.

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç  
[[MMU]] –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –º–µ–∂–¥—É [[root/CPU/CPU]] –∏ [[RAM]]:

1. –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ø–∞–º—è—Ç–∏ [[root/CPU/CPU]] –≤—ã–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å  
2. [[MMU]] –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–≥–æ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —á–µ—Ä–µ–∑ [[page tables]]  
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å/–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ)  
4. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ [[Cache]] –∏ –∑–∞—Ç–µ–º –≤ [[RAM]]  

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã MMU:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç           | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                 |
|---------------------|--------------------------------------------|
| TLB (Translation Lookaside Buffer) | –ö—ç—à –∞–¥—Ä–µ—Å–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π       |
| Page Table Walker   | –ü–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –ø–∞–º—è—Ç–∏, –µ—Å–ª–∏ –Ω–µ—Ç –≤ TLB    |
| Access Control      | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞                      |
| Address Translation Unit | –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ ‚Üí —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ |
| Exception Unit      | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: page fault, protection   |

## ‚öôÔ∏è –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

| –û–±–ª–∞—Å—Ç—å            | –†–æ–ª—å [[MMU]]                                    |
| ------------------ | ----------------------------------------------- |
| [[OS]]             | –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤     |
| [[Virtual Memory]] | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ –∫–∞–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è [[RAM]]      |
| Security           | –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ |
| [[Hypervisors]]    | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, EPT)   |

## üíª –ü—Ä–∏–º–µ—Ä (–Ω–∞ C —Å POSIX mmap)

```c
#include <sys/mman.h>

void *addr = mmap(NULL, 4096, PROT_READ | PROT_WRITE,
                  MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);
// MMU —Å–æ–∑–¥–∞—ë—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å
````

## üìê –°—Ö–µ–º–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤

```
[CPU] ‚Üí –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
   ‚Üì
[MMU] 
 ‚îú‚îÄ‚îÄ TLB (–µ—Å–ª–∏ –ø—Ä–æ–º–∞—Ö) 
 ‚îî‚îÄ‚îÄ Page Table Walker ‚Üí Page Table (–≤ RAM)
   ‚Üì
–§–∏–∑–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å ‚Üí Cache / RAM
```

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ [[Virtual Memory]]
    
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ –ø–∞–º—è—Ç–∏ (–∏–∑–æ–ª—è—Ü–∏—è)
    
- –ì–∏–±–∫–æ—Å—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ (paging, swapping)
    
- –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–±–æ–µ–≤ –∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–π
    

### ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- TLB misses ‚Üí —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–µ–∫
    
- –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã CPU
    
- –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã [[OS]] (—Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü, –∏—Å–∫–ª—é—á–µ–Ω–∏—è)