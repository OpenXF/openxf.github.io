---
title: Spinlock
aliases:
  - "Spinlock"
  - "—Å–ø–∏–Ω–ª–æ–∫"
  - "–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º"
tags:
  - "#concurrency"
  - "#synchronization"
  - "#lock"
  - "#multithreading"
  - "#glossary"
path:
  - "software/concurrency/spinlock"
---

## üìå Spinlock

**Spinlock** ‚Äî –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ö–∞–Ω–∏–∑–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö –∏ –º—É–ª—å—Ç–∏–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–ª—è –∑–∞—â–∏—Ç—ã —Ä–∞–∑–¥–µ–ª—è–µ–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–ø–∏–Ω–ª–æ–∫ –ø–æ—Ç–æ–∫ (–∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä) –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ —Ü–∏–∫–ª–µ –æ–∂–∏–¥–∞–Ω–∏—è (spin), –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–Ω–∞. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏–π –∏ –≤ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –≤—ã—Å–æ–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–µ–π –∑–∞ —Ä–µ—Å—É—Ä—Å—ã, –≥–¥–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–æ.

---

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã

- **–ü–æ–ø—ã—Ç–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞:** –ø–æ—Ç–æ–∫ –ø—ã—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, atomic test-and-set –∏–ª–∏ compare-and-swap).
- **–¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ:** –µ—Å–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–Ω—è—Ç–∞, –ø–æ—Ç–æ–∫ –≤—Ö–æ–¥–∏—Ç –≤ —Ü–∏–∫–ª –ø—Ä–æ–≤–µ—Ä–∫–∏, –ø–æ–≤—Ç–æ—Ä—è—è –ø–æ–ø—ã—Ç–∫–∏ –∑–∞—Ö–≤–∞—Ç–∞ (—Å–ø–∏–Ω).
- **–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ:** –≤–ª–∞–¥–µ–ª–µ—Ü –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–Ω–∏–º–∞–µ—Ç —Ñ–ª–∞–≥, –ø–æ–∑–≤–æ–ª—è—è –¥—Ä—É–≥–∏–º –ø–æ—Ç–æ–∫–∞–º –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–ø–∏–Ω–ª–æ–∫.
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –Ω–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∑–∞–¥–µ—Ä–∂–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞ –ø—Ä–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏—è—Ö.
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:** –ø–æ—Ç–µ—Ä—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–∂–∏–¥–∞–Ω–∏–∏ (busy-wait).

### –ë–ª–æ–∫-—Å—Ö–µ–º–∞

```mermaid
flowchart TB
    CPU["CPU / Thread"]
    Spinlock["Spinlock (atomic_flag)"]
    Memory["Shared Memory / Resource"]

    CPU -->|–ü–æ–ø—ã—Ç–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞| Spinlock
    Spinlock -- Busy wait --> CPU
    Spinlock -->|–î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω| Memory
    CPU -->|–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏| Memory
    CPU -->|–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ| Spinlock

    style Spinlock stroke:#fff,stroke-width:5px,font-weight:bold
```

### –ö–ª—é—á–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

- `lock(spinlock)` ‚Äî –ø–æ–ø—ã—Ç–∫–∞ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –∑–∞—Ü–∏–∫–ª–∏–≤–∞—è—Å—å, –ø–æ–∫–∞ –æ–Ω–∞ –Ω–µ —Å—Ç–∞–Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω–∞.
- `unlock(spinlock)` ‚Äî –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
- **Atomic primitives** ‚Äî —Ç–µ—Å—Ç –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è, –≤–∞–∂–Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–æ–Ω–æ–∫.

---

### –ü—Ä–∏–º–µ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–ø—Å–µ–≤–¥–æ–∫–æ–¥)

```text
function lock(spinlock):
    while atomic_test_and_set(spinlock) == LOCKED:
        ; // –∞–∫—Ç–∏–≤–Ω–æ –∂–¥–µ–º (spin)

function unlock(spinlock):
    atomic_clear(spinlock)
````

---

### –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

- **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å:** –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞—Ö–≤–∞—Ç–∞ –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞—Ç–æ–º–∞—Ä–Ω—ã–º–∏.
    
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –¥–ª—è SMP:** —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞–º–∏.
    
- **–ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:** –≤–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ "–≥–æ–ª–æ–¥–∞–Ω–∏—è" (starvation).
    
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –û–°:** —è–¥—Ä–æ Linux –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–ø–∏–Ω–ª–æ–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ SMP.
    
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞–º–∏:** —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç —Å–ø–∏–Ω–ª–æ–∫ —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–∞—É–∑—ã (pause/yield), —É–º–µ–Ω—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –∫—ç—à.
    

---

## ‚öôÔ∏è –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ —è–¥—Ä–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.
    
- –í —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.
    
- –í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.
    
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.
    
- –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∏ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.
    

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–∏ –∫—Ä–∞—Ç–∫–∏—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏—è—Ö.
    
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
    
- –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ SMP-—Å–∏—Å—Ç–µ–º–∞—Ö.
    
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
    
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ —è–¥—Ä–µ –û–°.
    

---

## ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –ü–æ—Ç–µ—Ä—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–∂–∏–¥–∞–Ω–∏–∏.
    
- –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –Ω–∞ –æ–¥–Ω–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.
    
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å "–≥–æ–ª–æ–¥–∞–Ω–∏—è" –ø–æ—Ç–æ–∫–æ–≤.
    
- –í—ã—Å–æ–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∏–∑-–∑–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è.
    
- –¢—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–µ–¥–ª–æ–∫–æ–≤.
    

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

[[Mutex]], [[Semaphore]], [[Atomic Operation]], [[Lock-Free]], [[Barrier]], [[SMP]], [[Preemption]], [[RTOS]], [[Linux Kernel Synchronization]], [[Futex]]

---

## –†–µ–∑—é–º–µ

Spinlock ‚Äî –±–∞–∑–æ–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º –æ–∂–∏–¥–∞–Ω–∏–µ–º, –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–π –¥–ª—è –∑–∞—â–∏—Ç—ã –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏–π –≤ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∏–∑–∫–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∏ –ø—Ä–æ—Å—Ç–æ—Ç—É, –Ω–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∞–∫—Ç–∏–≤–Ω—ã–º —Ü–∏–∫–ª–æ–º. –ö–ª—é—á–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ —è–¥—Ä–∞—Ö –û–° –∏ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –≤—ã—Å–æ–∫–æ–π —Å—Ç–µ–ø–µ–Ω—å—é –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.

---

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

#### C: –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏–Ω–ª–æ–∫ –Ω–∞ atomic_flag (C11)

```c
#include <stdatomic.h>

typedef struct {
    atomic_flag flag;
} spinlock_t;

void spinlock_init(spinlock_t *lock) {
    atomic_flag_clear(&lock->flag);
}

void spinlock_lock(spinlock_t *lock) {
    while (atomic_flag_test_and_set_explicit(&lock->flag, memory_order_acquire)) {
        // active wait (spin)
    }
}

void spinlock_unlock(spinlock_t *lock) {
    atomic_flag_clear_explicit(&lock->flag, memory_order_release);
}
```

#### C++: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ std::atomic_flag

```cpp
#include <atomic>

class SpinLock {
    std::atomic_flag flag = ATOMIC_FLAG_INIT;
public:
    void lock() {
        while(flag.test_and_set(std::memory_order_acquire)) {
            // spin
        }
    }
    void unlock() {
        flag.clear(std::memory_order_release);
    }
};
```

#### –ê—Å—Å–µ–º–±–ª–µ—Ä x86: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è LOCK CMPXCHG –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ —Å–ø–∏–Ω–ª–æ–∫–∞

```assembly
spin_lock:
    mov eax, 0          ; –æ–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0 - —Å–≤–æ–±–æ–¥–Ω–æ)
try_lock:
    mov ebx, 1          ; –∑–Ω–∞—á–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (1 - –∑–∞–Ω—è—Ç–æ)
    lock cmpxchg [lock_var], ebx
    jne try_lock        ; –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞—Ö–≤–∞—Ç–∏—Ç—å ‚Äî –ø–æ–≤—Ç–æ—Ä–∏—Ç—å
    ret
```

---

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**  
Linux Kernel Documentation, Intel x86 Architectures Manuals, C11 standard, C++11 std::atomic, OSDev.org, Wikipedia, "Operating Systems: Three Easy Pieces" by Remzi & Andrea Arpaci-Dusseau.