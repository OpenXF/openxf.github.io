---
aliases:
  - "NAT"
  - "Network Address Translation"
  - "—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∞–¥—Ä–µ—Å–æ–≤"
tags:
  - "#network #protocols #routing #security"
path:
  - "–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ/—Å–µ—Ç–∏/–ø—Ä–æ—Ç–æ–∫–æ–ª—ã"
---

## üìå NAT  
Network Address Translation [[NAT]] ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º IP-–∞–¥—Ä–µ—Å–∞ —á–∞—Å—Ç–Ω–æ–π —Å–µ—Ç–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤, –ø–æ–∑–≤–æ–ª—è—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —É–∑–ª–∞–º –≤—ã—Ö–æ–¥–∏—Ç—å –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç.

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç  
[[NAT]] —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Å–µ—Ç–∏ (–æ–±—ã—á–Ω–æ –≤ [[Router]] –∏–ª–∏ [[Firewall]]), –∏–∑–º–µ–Ω—è—è:

- –ò—Å—Ç–æ—á–Ω–∏–∫ IP/–ø–æ—Ä—Ç–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏  
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ IP/–ø–æ—Ä—Ç–∞ –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ —Å–Ω–∞—Ä—É–∂–∏

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã:

| –¢–∏–ø              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                       |
|------------------|--------------------------------------------------|
| **SNAT**         | –ó–∞–º–µ–Ω–∞ *source* IP –¥–ª—è –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞       |
| **DNAT**         | –ó–∞–º–µ–Ω–∞ *destination* IP –¥–ª—è –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞   |
| **PAT**          | –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ IP+–ø–æ—Ä—Ç–æ–≤ (Port Address Translation) ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–æ–≥–∏–º —Ö–æ—Å—Ç–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω IP |

–†–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ [[Firewall]], [[Router]] –∏–ª–∏ —á–µ—Ä–µ–∑ [[iptables]].

## ‚öôÔ∏è –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

| –°—Ü–µ–Ω–∞—Ä–∏–π                  | –û–ø–∏—Å–∞–Ω–∏–µ                                 |
|---------------------------|-------------------------------------------|
| –î–æ–º–∞—à–Ω–∏–µ —Å–µ—Ç–∏             | –û–¥–∏–Ω –≤–Ω–µ—à–Ω–∏–π IP –Ω–∞ –≤–µ—Å—å [[LAN]]           |
| [[Cloud]] –∏ [[VPC]]       | –ò–∑–æ–ª—è—Ü–∏—è –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–µ         |
| [[Kubernetes]]            | [[Kube-proxy]], [[Ingress]], [[Service]] |
| [[Firewall]]              | –°–∫—Ä—ã—Ç–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–µ—Ç–∏         |

## üíª –ü—Ä–∏–º–µ—Ä (iptables SNAT)

```bash
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
````

## üìê –°—Ö–µ–º–∞ NAT

```
[LAN Host] ‚Üí 192.168.1.10:1234
      ‚Üì
[NAT Router] ‚Üí 203.0.113.1:5555
      ‚Üì
[Internet Server] ‚Üê 203.0.113.1:5555
                ‚Üê NAT ‚Üê 192.168.1.10:1234
```

## üß© –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

- [[RFC1918]] ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω—ã —á–∞—Å—Ç–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
    
- [[STUN]], [[TURN]], [[ICE]] ‚Äî —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –æ–±—Ö–æ–¥–∞ NAT
    
- [[Hairpin NAT]] ‚Äî –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–≤–æ–µ–º—É –≤–Ω–µ—à–Ω–µ–º—É IP –∏–∑–Ω—É—Ç—Ä–∏
    

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –≠–∫–æ–Ω–æ–º–∏—è –ø—É–±–ª–∏—á–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
    
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Å–∫—Ä—ã—Ç–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏)
    
- –ì–∏–±–∫–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∏–∑–æ–ª—è—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
    

### ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –ù–∞—Ä—É—à–∞–µ—Ç —Å–∫–≤–æ–∑–Ω—É—é –∞–¥—Ä–µ—Å–∞—Ü–∏—é (End-to-End)
    
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å NAT-traversal (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ [[VoIP]], [[P2P]])
    
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É –∏ –ª–æ–≥–∏–∫—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π