---
aliases:
  - "DPDK"
  - "Data Plane Development Kit"
  - "userspace –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞"
tags:
  - "#network #performance #packet-processing"
path:
  - "–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ/—Å–µ—Ç–∏/—É—Å–∫–æ—Ä–µ–Ω–∏–µ"
---

## üìå DPDK  
Data Plane Development Kit [[DPDK]] ‚Äî –Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –º–∏–Ω—É—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å—Ç–µ–∫ [[kernel]].

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç  
[[DPDK]] –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ [[PMD]] (Poll Mode Drivers), –Ω–∞–ø—Ä—è–º—É—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏–µ —Å [[NIC]] —á–µ—Ä–µ–∑ [[PCIe]] —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

- [[HugePages]] ‚Äî –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é  
- [[NUMA]]-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –∏ –±—É—Ñ–µ—Ä–æ–≤  
- [[Poll-based IO]] ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –æ–ø—Ä–æ—Å –±—É—Ñ–µ—Ä–∞, –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π  
- [[Zero-copy]] ‚Äî –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–∞–∫–µ—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ ring-–±—É—Ñ–µ—Ä–∞—Ö (`rte_ring`) –∏ memory pool'–∞—Ö (`rte_mempool`) –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏.

## ‚öôÔ∏è –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

| –°—Ñ–µ—Ä–∞               | –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è                   |
| ------------------- | --------------------------------------- |
| [[NFV]]             | [[vRouter]], [[vFirewall]], [[vSwitch]] |
| [[Telecom]]         | EPC, 5G Core, IMS                       |
| [[DDoS]] Protection | [[XDP]] + [[DPDK]] –≥–∏–±—Ä–∏–¥–Ω—ã–µ —Å—Ö–µ–º—ã      |
| Traffic Generator   | [[Pktgen]], [[TRex]]                    |
| [[Load Balancing]]  | [[Katran]], [[HAProxy]] —Å DPDK backend  |

## üíª –ü—Ä–∏–º–µ—Ä (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è EAL –∏ –∑–∞–ø—É—Å–∫ –ø–æ—Ä—Ç–∞)

```c
rte_eal_init(argc, argv);                       // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ä–µ–¥—ã
port_id = 0;
rte_eth_dev_configure(port_id, rx_queues, tx_queues, &port_conf);
rte_eth_rx_queue_setup(port_id, ...);
rte_eth_tx_queue_setup(port_id, ...);
rte_eth_dev_start(port_id);                     // –∑–∞–ø—É—Å–∫ –ø–æ—Ä—Ç–∞
````

## üìê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ DPDK

```
[App Thread]
   ‚Üì
[DPDK API]
   ‚Üì
[PMD Driver] ‚Üí [NIC]
         ‚Üñ     |
     [HugePages, Mempool]
```

## üß© –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∂–µ–ª–µ–∑–æ–º

- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞–º [[NIC]] (—á–µ—Ä–µ–∑ [[UIO]] / [[VFIO]])
    
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ [[Polling]] –≤–º–µ—Å—Ç–æ [[Interrupts]]
    
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ [[SR-IOV]], [[Multiqueue]], [[RSS]]
    

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å: –º–∏–ª–ª–∏–æ–Ω—ã –ø–∞–∫–µ—Ç–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É (pps)
    
- –ú–∏–Ω—É–µ—Ç—Å—è [[kernel]] ‚Äî –Ω–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
    
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ [[SDN]]
    

### ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- –¢—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ CPU –∏ –ø–∞–º—è—Ç–∏ (Core Pinning, [[HugePages]])
    
- –ù–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–±—ã—á–Ω—ã–º–∏ —Å–æ–∫–µ—Ç–∞–º–∏ –±–µ–∑ [[AF_XDP]] –∏–ª–∏ [[vhost]]
    
- –ù–µ–æ–±—Ö–æ–¥–∏–º—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –∏ [[NIC]]