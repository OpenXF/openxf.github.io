---
aliases:
  - "AHCI"
  - "Advanced Host Controller Interface"
  - "Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ° SATA"
tags:
  - "#storage #hardware #protocol"
path:
  - "ĞºĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ñ‹Ğµ/Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñ‹/Ğ½Ğ°ĞºĞ¾Ğ¿Ğ¸Ñ‚ĞµĞ»Ğ¸"
---

## ğŸ“Œ ĞšÑ€Ğ°Ñ‚ĞºĞ¾  
[[AHCI]] (Advanced Host Controller Interface) â€” ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ° Ğ¼ĞµĞ¶Ğ´Ñƒ [[SATA]]-ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ¾Ğ¼ Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹, Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ÑÑ‰Ğ¸Ğ¹ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ½Ğ°ĞºĞ¾Ğ¿Ğ¸Ñ‚ĞµĞ»ÑĞ¼ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¸ [[DMA]].

## ğŸ§  ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚  
[[AHCI]] Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹, ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ Ğ¸ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ° SATA. Ğ¯Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ¼Ğ¾ÑÑ‚Ğ¾Ğ¼ Ğ¼ĞµĞ¶Ğ´Ñƒ [[Disk Controller]] Ğ¸ [[OS]] [[kernel]], Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑ ĞĞ¡ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ Ğ´Ğ¸ÑĞºĞ°Ğ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğµ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ñ‹.

ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:
- [[NCQ]] (Native Command Queuing)  
- [[Hot plug]] (Ğ³Ğ¾Ñ€ÑÑ‡ĞµĞµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ SATA-ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²)  
- [[DMA]]-Ğ¾Ñ€Ğ¸ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…  
- Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ¸Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ¾Ğ² Ğ¸ BIOS

Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… [[PCI]]/[[PCIe]] Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· [[HBA]] (Host Bus Adapter).

## âš™ï¸ Ğ“Ğ´Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ

| Ğ£ÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾          | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                               |
|---------------------|-------------------------------------------|
| [[SATA HDD/SSD]]    | Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ñ ĞĞ¡             |
| [[BIOS/UEFI]]       | Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ² Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ AHCI     |
| [[Linux/Windows]]   | Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ñ‹ Ğ´Ğ¸ÑĞºĞ¾Ğ²             |
| [[Laptops/Desktops]]| ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ³Ğ¾Ñ€ÑÑ‡ĞµĞ¹ Ğ·Ğ°Ğ¼ĞµĞ½Ñ‹ Ğ¸ NCQ            |

## ğŸ’» ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ (Ğ¿ÑĞµĞ²Ğ´Ğ¾ĞºĞ¾Ğ´ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ OS/driver)

```c
// Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ñ€Ñ‚Ğ° AHCI
ahci_port->cmd = 0x1; // Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ñƒ
ahci_port->ci |= (1 << slot); // ÑƒĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑĞ»Ğ¾Ñ‚ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
````

## ğŸ§© Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹

|Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°|ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ|
|---|---|
|HBA Memory Registers|Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ñ€Ñ‚Ğ°Ğ¼Ğ¸, ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°Ğ¼Ğ¸, Ğ±ÑƒÑ„ĞµÑ€Ğ°Ğ¼Ğ¸|
|Command List|ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ (NCQ)|
|Command Table|ĞÑ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´, Ğ´ĞµÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ñ€Ñ‹ DMA|
|Received FIS|ĞÑ‚Ğ²ĞµÑ‚Ñ‹ Ğ¾Ñ‚ Ğ´Ğ¸ÑĞºĞ° (Frame Information Structure)|
|Ports (0â€“31)|Ğ”Ğ¾ 32 Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²|

## ğŸ“ Ğ¡Ñ…ĞµĞ¼Ğ° Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ

```
+-----------+       +---------+       +------------+
|   OS      | â†” DMA |  HBA    | â†” FIS |  SATA Disk |
|  Driver   |       | (AHCI)  |       | (HDD/SSD)  |
+-----------+       +---------+       +------------+
```

### âœ… ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°

- Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº SATA-Ğ´Ğ¸ÑĞºĞ°Ğ¼
    
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¾Ñ‡ĞµÑ€ĞµĞ´ĞµĞ¹ (NCQ), DMA, Ğ³Ğ¾Ñ€ÑÑ‡ĞµĞ¹ Ğ·Ğ°Ğ¼ĞµĞ½Ñ‹
    
- Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ñ ĞĞ¡ Ğ¸ BIOS
    

### âŒ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸

- ĞĞµ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ´Ğ»Ñ [[SSD]]: Ğ²Ñ‹ÑĞ¾ĞºĞ¸Ğµ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸ Ğ¸ ÑƒĞ·ĞºĞ°Ñ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
    
- Ğ£ÑÑ‚Ğ°Ñ€ĞµĞ²Ğ°Ğ½Ğ¸Ğµ: Ğ·Ğ°Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ [[NVMe]] Ğ² ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ñ…
    
- Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¾Ñ‚ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ° (Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ Ğ² Ğ½Ğ¾ÑƒÑ‚Ğ±ÑƒĞºĞ°Ñ…)